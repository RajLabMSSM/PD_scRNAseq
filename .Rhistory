root = "./"
source(file.path(root,"MAIN.R"))
import_parameters(params)
# load("Results/Current_Pipeline/scRNAseq_results.RData")
# load(file.path(resultsPath, "3-11-2019/scRNAseq_results.RData"))
load(file.path("Data", "monocle3_CDS.RData"))
######################################################
#### #### PACKAGES #### ####
######################################################
print("Written using: Seurat version* 2.3.4 2018-07-17")
# https://satijalab.org/seurat/install.html
# source("http://bit.ly/archived-seurat")
library(Seurat)
paste("Seurat", packageVersion("Seurat"))
# library(monocle) # BiocManager::install("monocle")
# paste("monocle", packageVersion("monocle"))
library(monocle3)
paste("monocle3", packageVersion("monocle3"))
library(garnett) # devtools::install_github("cole-trapnell-lab/garnett")
paste("garnett", packageVersion("garnett"))
library(cowplot)
library(ggplot2)
library(dplyr)
library(data.table)
library(readxl)
library(reshape2)
library(ggrepel)
library(plotly)
library(GeneOverlap) # BiocManager::install("GeneOverlap")
######################################################
# Exporting 3D plots
knitr::knit_hooks$set(webgl = rgl::hook_webgl)
dge_limit <- F # 100
nCores <- 4#parallel::detectCores()
set.seed(2019)
cds
pData(cds)
ggplot(pData(cds), aes(x=dx, fill=Cluster)) + geom_count()
ggplot(pData(cds), aes(x=dx, fill=Cluster)) + geom_bar()
meta <- data.frame(pData(cds))
ggplot(meta, aes(x=dx, fill=Cluster)) + geom_bar()
ggplot(meta, aes(x=dx, fill=Cluster)) + geom_bar(stat="percent")
ggplot(meta, aes(x=dx, fill=Cluster)) + geom_bar()
# Count of each Cluster
ggplot(meta) + geom_bar( aes(x=dx, y=..prop.., fill=Cluster))
# Count of each Cluster
ggplot(meta, aes(x=dx, fill=Cluster)) + geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count")
# Count of each Cluster
ggplot(meta, aes(x=dx, fill=Cluster)) + geom_bar(aes(y = ..prop.., fill = factor(..fill..)), stat="count")
# Count of each Cluster
ggplot(meta, aes(x=dx, fill=Cluster)) + geom_bar(aes(y = ..prop..), stat="count")
# Count of each Cluster
ggplot(meta, aes(x=dx)) +  geom_bar(aes(y = (..count..)/sum(..count..))) +
# Count of each Cluster
ggplot(meta, aes(x=dx)) +  geom_bar(aes(y = (..count..)/sum(..count..)))
# Count of each Cluster
ggplot(meta, aes(x=dx)) + geom_bar(aes(y = (..count..)/sum(..count..)))
# Count of each Cluster
ggplot(meta, aes(x=dx, fill=Cluster)) + geom_bar(aes(y = (..count..)/sum(..count..)))
meta %>% dplyr::group_by(dx, Cluster) %>% count()
meta %>% dplyr::group_by(dx, Cluster) %>% prop.table()
meta %>% dplyr::group_by(dx, Cluster) %>% dplyr::summarise(Percent = n()/sum(n()))
meta %>% dplyr::group_by(dx, Cluster) %>% dplyr::summarise(Percent = count()/sum(n()))
meta %>% dplyr::group_by(dx, Cluster) %>% dplyr::summarise(Percent = n()/sum( ))
myplot <- ggplot(tips, aes(day, group = sex)) +
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") +
facet_grid(~sex)
myplot
myplot <- ggplot(meta, aes(dx, group = Cluster)) +
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") +
facet_grid(~sex)
myplot
myplot <- ggplot(meta, aes(dx, group = Cluster)) +
geom_bar(aes(y = ..prop.., fill = factor(..x..)), stat="count") +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") +
facet_grid(~dx)
myplot
myplot <- ggplot(meta, aes(dx, group = Cluster)) +
geom_bar(aes(y = ..prop.., fill = factor(Cluster)), stat="count") +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") +
facet_grid(~dx)
myplot
myplot <- ggplot(meta, aes(dx, group = Cluster)) +
geom_bar(aes(y = ..prop.., fill = factor(Cluster)), stat="count") +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies")
myplot
myplot <- ggplot(meta, aes(dx, group = Cluster)) +
geom_bar(aes(y = ..prop.., fill = factor(Cluster)), stat="count", position="dodged") +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") +
myplot
myplot <- ggplot(meta, aes(dx, group = Cluster)) +
geom_bar(aes(y = ..prop.., fill = factor(Cluster)), stat="count", position="dodge") +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies") +
myplot
myplot
myplot <- ggplot(meta, aes(dx, group = Cluster)) +
geom_bar(aes(y = ..prop.., fill = factor(Cluster)), stat="count", position="dodge") +
scale_y_continuous(labels=scales::percent) +
ylab("relative frequencies")
myplot
myplot <- ggplot(meta, aes(dx, group = Cluster)) +
geom_bar(aes(y = ..prop.., fill = factor(Cluster)), stat="count", position="dodge") +
# scale_y_continuous(labels=scales::percent) +
ylab("% Cells")
myplot
myplot <- ggplot(meta, aes(dx, fill = Cluster)) +
geom_bar(aes(y = ..prop.., fill = factor(Cluster)), stat="count", position="dodge") +
# scale_y_continuous(labels=scales::percent) +
ylab("Proportion of Cells")
myplot
myplot <- ggplot(meta, aes(dx, fill = Cluster)) +
geom_bar(aes(y = ..prop.., ), stat="count", position="dodge") +
# scale_y_continuous(labels=scales::percent) +
ylab("Proportion of Cells")
myplot <- ggplot(meta, aes(dx, fill = Cluster)) +
geom_bar(aes(y = ..prop..), stat="count", position="dodge") +
# scale_y_continuous(labels=scales::percent) +
ylab("Proportion of Cells")
myplot
myplot <- ggplot(meta, aes(dx, group = Cluster)) +
geom_bar(aes(y = ..prop.., fill = factor(Cluster)), stat="count", position="dodge") +
# scale_y_continuous(labels=scales::percent) +
ylab("Proportion of Cells")
myplot
myplot <- ggplot(meta, aes(dx, group = Cluster)) +
geom_bar(aes(y = ..prop.., group = factor(Cluster)), stat="count", position="dodge") +
# scale_y_continuous(labels=scales::percent) +
ylab("Proportion of Cells")
myplot
?ggplot
myplot
myplot <- ggplot(meta, aes(dx, group = Cluster)) +
geom_bar(aes(y = ..prop.., fill = factor(Cluster)), stat="count", position="dodge") +
# scale_y_continuous(labels=scales::percent) +
ylab("Proportion of Cells")
myplot
meta %>%
group_by(dx, Cluster) %>%
summarise(Percentage=n()) %>%
group_by(dx) %>%
mutate(Percentage=Percentage/sum(Percentage)*100)
meta %>%
group_by(dx, Cluster) %>%
summarise(Proportion=n()) %>%
group_by(dx) %>%
mutate(Proportion=Proportion/sum(Proportion))
View(meta)
meta <- data.frame(pData(cds))
cell_proportions <- meta %>%
group_by(dx, Cluster) %>%
summarise(Proportion=n()) %>%
group_by(dx) %>%
mutate(Proportion=Proportion/sum(Proportion))
cell_proportions
# Count of each Cluster
myplot <- ggplot(cell_proportions, aes(x=dx, y=Proportion, group = Cluster)) +
geom_bar()
ylab("Proportion of Cells")
# Count of each Cluster
myplot <- ggplot(cell_proportions, aes(x=dx, y=Proportion, group = Cluster)) +
geom_bar() +
ylab("Proportion of Cells")
myplot
# Count of each Cluster
myplot <- ggplot(cell_proportions, aes(x=dx, y=Proportion, group = Cluster)) +
geom_col() +
ylab("Proportion of Cells")
myplot
# Count of each Cluster
myplot <- ggplot(cell_proportions, aes(x=dx, y=Proportion, fill = Cluster)) +
geom_col() +
ylab("Proportion of Cells")
myplot
# Count of each Cluster
prop.plot <- ggplot(cell_proportions, aes(x=dx, y=Proportion, fill = Cluster)) +
geom_col() +
ylab("Proportion of Cells")
prop.plot
# By mut
cell_proportions <- meta %>%
group_by(mut, Cluster) %>%
summarise(Proportion=n()) %>%
group_by(mut) %>%
mutate(Proportion=Proportion/sum(Proportion))
prop.plot <- ggplot(cell_proportions, aes(x=mut, y=Proportion, fill = Cluster)) +
geom_col() +
ylab("Proportion of Cells")
prop.plot
# By dx
cell_proportions <- meta %>%
group_by(dx, Cluster) %>%
summarise(Proportion=n()) %>%
group_by(dx) %>%
mutate(Proportion=Proportion/sum(Proportion))
prop.dx <- ggplot(cell_proportions, aes(x=dx, y=Proportion, fill = Cluster)) +
geom_col() +
ylab("Proportion of Cells")
prop.dx
printer(cell_proportions)
print(paste(subset(cell_proportions, Cluster==1)$Proportion))
print(paste( subset(cell_proportions, Cluster==1 & dx=="PD")$Proportion) )
createDT(cell_proportions)
print(paste( subset(cell_proportions, Cluster==1 & dx=="PD")$Proportion) )
subset(cell_proportions, Cluster==1 & dx=="PD")$Proportion) -
subset(cell_proportions, Cluster==1 & dx=="PD")$Proportion) -subset(cell_proportions, Cluster==1 & dx=="Control")$Proportion)
subset(cell_proportions, Cluster==1 & dx=="Control")$Proportion)
subset(cell_proportions, Cluster==1 & dx=="PD")$Proportion) - subset(cell_proportions, Cluster==1 & dx=="Control")$Proportion
subset(cell_proportions, Cluster==1 & dx=="PD")$Proportion - subset(cell_proportions, Cluster==1 & dx=="Control")$Proportion
subset(cell_proportions, Cluster==1 & dx=="PD")$Proportion - subset(cell_proportions, Cluster==1 & dx=="control")$Proportion
difference <- (subset(cell_proportions, Cluster==1 & dx=="PD")$Proportion - subset(cell_proportions, Cluster==1 & dx=="control")$Proportion)*100
difference
clust1.diff <- (subset(cell_proportions, Cluster==1 & dx=="PD")$Proportion - subset(cell_proportions, Cluster==1 & dx=="control")$Proportion)*100
print(paste("There is a",clust1.diff,"% increase in the number of Cluster 1 (Canonical Monocyte) cells in Controls vs. PD."))
clust1.diff <- (subset(cell_proportions, Cluster==1 & dx=="PD")$Proportion - subset(cell_proportions, Cluster==1 & dx=="control")$Proportion)*100 %>% round(2)
print(paste("There is a",clust1.diff,"% increase in the number of Cluster 1 (Canonical Monocyte) cells in Controls vs. PD."))
print(paste("There is a",round(clust1.diff, 2),"% increase in the number of Cluster 1 (Canonical Monocyte) cells in Controls vs. PD."))
1:2
for(clust in 1:2)
key
clust.key <- list(1="Canonical Monocytes", 2="Intermediate Monocytes")
clust.key <- list("1"="Canonical Monocytes", "2"="Intermediate Monocytes")
clust.key
clust.key[1]
clust.key[[1]]
print(paste("There is a",round(clust1.diff, 2),"% increase in the number of Cluster",clust,"(",clust.key[[as.character(1)]], ") cells in Controls vs. PD."))
print(paste("There is a",round(clust1.diff, 2),"% increase in the number of Cluster",clust,"(",clust.key[[as.character(clust)]], ") cells in Controls vs. PD."))
for(clust in 1:2){
clust1.diff <- (subset(cell_proportions, Cluster==clust & dx=="PD")$Proportion - subset(cell_proportions, Cluster==clust & dx=="control")$Proportion)*100
print(paste("There is a",round(clust1.diff, 2),"% increase in the number of Cluster",clust,"(",clust.key[[as.character(clust)]], ") cells in Controls vs. PD."))
}
print(paste("There is a",round(clust1.diff, 2),"% difference in the number of Cluster",clust,"(",clust.key[[as.character(clust)]], ") cells in Controls compared to PD."))
for(clust in 1:2){
clust1.diff <- (subset(cell_proportions, Cluster==clust & dx=="PD")$Proportion - subset(cell_proportions, Cluster==clust & dx=="control")$Proportion)*100
print(paste("There is a",round(clust1.diff, 2),"% difference in the number of Cluster",clust,"(",clust.key[[as.character(clust)]], ") cells in Controls compared to PD."))
}
print(paste("There is a",round(clust1.diff, 2),"% difference in the number of Cluster",clust,"cells (",clust.key[[as.character(clust)]], ") in Controls compared to PD."))
for(clust in 1:2){
clust1.diff <- (subset(cell_proportions, Cluster==clust & dx=="PD")$Proportion - subset(cell_proportions, Cluster==clust & dx=="control")$Proportion)*100
print(paste("There is a",round(clust1.diff, 2),"% difference in the number of Cluster",clust,"cells (",clust.key[[as.character(clust)]], ") in Controls compared to PD."))
}
meta <- data.frame(pData(cds))
# By dx
cell_proportions <- meta %>%
group_by(dx, Cluster) %>%
summarise(Proportion=n()) %>%
group_by(dx) %>%
mutate(Proportion=Proportion/sum(Proportion))
createDT(cell_proportions)
prop.dx <- ggplot(cell_proportions, aes(x=dx, y=Proportion, fill = Cluster)) +
geom_col() +
ylab("Proportion of Cells")
print(prop.dx)
clust.key <- list("1"="Canonical Monocytes", "2"="Intermediate Monocytes")
for(clust in 1:2){
clust1.diff <- (subset(cell_proportions, Cluster==clust & dx=="PD")$Proportion - subset(cell_proportions, Cluster==clust & dx=="control")$Proportion)*100
print(paste("There is a",round(clust1.diff, 2),"% difference in the number of Cluster",clust,"cells (",clust.key[[as.character(clust)]], ") in Controls compared to PD."))
}
# By mut
cell_proportions <- meta %>%
group_by(mut, Cluster) %>%
summarise(Proportion=n()) %>%
group_by(mut) %>%
mutate(Proportion=Proportion/sum(Proportion))
createDT(cell_proportions)
prop.mut <- ggplot(cell_proportions, aes(x=mut, y=Proportion, fill = Cluster)) +
geom_col() +
ylab("Proportion of Cells")
print(prop.mut)
meta <- data.frame(pData(cds))
# By dx
cell_proportions <- meta %>%
group_by(dx, Cluster) %>%
summarise(Proportion=n()) %>%
group_by(dx) %>%
mutate(Proportion=Proportion/sum(Proportion))
createDT(cell_proportions)
prop.dx <- ggplot(cell_proportions, aes(x=dx, y=Proportion, fill = Cluster)) +
geom_col() +
ylab("Proportion of Cells")
print(prop.dx)
clust.key <- list("1"="Canonical Monocytes", "2"="Intermediate Monocytes")
for(clust in 1:2){
clust1.diff <- (subset(cell_proportions, Cluster==clust & dx=="PD")$Proportion - subset(cell_proportions, Cluster==clust & dx=="control")$Proportion)*100
print(paste("There is a",round(clust1.diff, 2),"% difference in the number of Cluster",clust,"cells (",clust.key[[as.character(clust)]], ") in Controls compared to PD."))
}
# By mut
cell_proportions <- meta %>%
group_by(mut, Cluster) %>%
summarise(Proportion=n()) %>%
group_by(mut) %>%
mutate(Proportion=Proportion/sum(Proportion))
createDT(cell_proportions)
prop.mut <- ggplot(cell_proportions, aes(x=mut, y=Proportion, fill = Cluster)) +
geom_col() +
ylab("Proportion of Cells")
print(prop.mut)
clust.key <- list("1"="Canonical Monocytes", "2"="Intermediate Monocytes")
for(clust in 1:2){
clust1.diff <- (subset(cell_proportions, Cluster==clust & dx=="PD")$Proportion - subset(cell_proportions, Cluster==clust & dx=="control")$Proportion)*100
print(paste("There is a",round(clust1.diff, 2),"% difference in the number of Cluster",clust,"cells (",clust.key[[as.character(clust)]], ") in Controls compared to PD."))
}
# By mut
cell_proportions <- meta %>%
group_by(mut, Cluster) %>%
summarise(Proportion=n()) %>%
group_by(mut) %>%
mutate(Proportion=Proportion/sum(Proportion))
createDT(cell_proportions)
prop.mut <- ggplot(cell_proportions, aes(x=mut, y=Proportion, fill = Cluster)) +
geom_col() +
ylab("Proportion of Cells")
print(prop.mut)
clust.key <- list("1"="Canonical Monocytes", "2"="Intermediate Monocytes")
for(clust in 1:2){
clust1.diff <- (subset(cell_proportions, Cluster==clust & mut=="PD")$Proportion - subset(cell_proportions, Cluster==clust & mut=="control")$Proportion)*100
print(paste("There is a",round(clust1.diff, 2),"% difference in the number of Cluster",clust,"cells (",clust.key[[as.character(clust)]], ") in Controls compared to PD."))
}
# By mut
cell_proportions <- meta %>%
group_by(mut, Cluster) %>%
summarise(Proportion=n()) %>%
group_by(mut) %>%
mutate(Proportion=Proportion/sum(Proportion))
createDT(cell_proportions)
prop.mut <- ggplot(cell_proportions, aes(x=mut, y=Proportion, fill = Cluster)) +
geom_col() +
ylab("Proportion of Cells")
print(prop.mut)
# By mut
cell_proportions <- meta %>%
group_by(mut, Cluster) %>%
summarise(Proportion=n()) %>%
group_by(mut) %>%
mutate(Proportion=Proportion/sum(Proportion))
createDT(cell_proportions)
prop.mut <- ggplot(cell_proportions, aes(x=mut, y=Proportion, fill = Cluster)) +
geom_col(position="dodge") +
ylab("Proportion of Cells")
print(prop.mut)
meta <- data.frame(pData(cds))
# By dx
cell_proportions <- meta %>%
group_by(dx, Cluster) %>%
summarise(Proportion=n()) %>%
group_by(dx) %>%
mutate(Proportion=Proportion/sum(Proportion))
createDT(cell_proportions)
prop.dx <- ggplot(cell_proportions, aes(x=dx, y=Proportion, fill = Cluster)) +
geom_col(position="dodge") +
ylab("Proportion of Cells")
print(prop.dx)
clust.key <- list("1"="Canonical Monocytes", "2"="Intermediate Monocytes")
for(clust in 1:2){
clust1.diff <- (subset(cell_proportions, Cluster==clust & dx=="PD")$Proportion - subset(cell_proportions, Cluster==clust & dx=="control")$Proportion)*100
print(paste("There is a",round(clust1.diff, 2),"% difference in the number of Cluster",clust,"cells (",clust.key[[as.character(clust)]], ") in Controls compared to PD."))
}
# By mut
cell_proportions <- meta %>%
group_by(mut, Cluster) %>%
summarise(Proportion=n()) %>%
group_by(mut) %>%
mutate(Proportion=Proportion/sum(Proportion))
createDT(cell_proportions)
prop.mut <- ggplot(cell_proportions, aes(x=mut, y=Proportion, fill = Cluster)) +
geom_col() + # position="dodge"
ylab("Proportion of Cells")
print(prop.mut)
meta <- data.frame(pData(cds))
# By dx
cell_proportions <- meta %>%
group_by(dx, Cluster) %>%
summarise(Proportion=n()) %>%
group_by(dx) %>%
mutate(Proportion=Proportion/sum(Proportion))
createDT(cell_proportions)
prop.dx <- ggplot(cell_proportions, aes(x=dx, y=Proportion, fill = Cluster)) +
geom_col() + # position="dodge"
ylab("Proportion of Cells")
print(prop.dx)
clust.key <- list("1"="Canonical Monocytes", "2"="Intermediate Monocytes")
for(clust in 1:2){
clust1.diff <- (subset(cell_proportions, Cluster==clust & dx=="PD")$Proportion - subset(cell_proportions, Cluster==clust & dx=="control")$Proportion)*100
print(paste("There is a",round(clust1.diff, 2),"% difference in the number of Cluster",clust,"cells (",clust.key[[as.character(clust)]], ") in Controls compared to PD."))
}
meta
# By mut
cell_proportions <- meta %>%
group_by(ID, Cluster) %>%
summarise(Proportion=n()) %>%
group_by(ID) %>%
mutate(Proportion=Proportion/sum(Proportion))
createDT(cell_proportions)
prop.mut <- ggplot(cell_proportions, aes(x=ID, y=Proportion, fill = Cluster)) +
geom_col() + # position="dodge"
ylab("Proportion of Cells")
# By mut
cell_proportions <- meta %>%
group_by(ID, Cluster) %>%
summarise(Proportion=n()) %>%
group_by(ID) %>%
mutate(Proportion=Proportion/sum(Proportion))
createDT(cell_proportions)
prop.ID <- ggplot(cell_proportions, aes(x=ID, y=Proportion, fill = Cluster)) +
geom_col() + # position="dodge"
ylab("Proportion of Cells")
print(prop.ID)
prop.ID <- ggplot(cell_proportions, aes(x=ID, y=Proportion, fill = Cluster)) +
geom_col() + # position="dodge"
ylab("Proportion of Cells") + facet_grid("~dx")
print(prop.ID)
# By mut
cell_proportions <- meta %>%
group_by(dx, Cluster, ID) %>%
summarise(Proportion=n()) %>%
group_by(ID) %>%
mutate(Proportion=Proportion/sum(Proportion))
cell_proportions
createDT(cell_proportions)
prop.ID <- ggplot(cell_proportions, aes(x=ID, y=Proportion, fill = Cluster)) +
geom_col() + # position="dodge"
ylab("Proportion of Cells") + facet_grid("~dx")
print(prop.ID)
cell_proportions
# By mut
cell_proportions <- meta %>%
group_by(dx, Cluster, ID) %>%
summarise(Proportion=n()) %>%
group_by(dx) %>%
mutate(Proportion=Proportion/sum(Proportion))
cell_proportions
# By mut
cell_proportions <- meta %>%
group_by(dx, Cluster, ID) %>%
summarise(Proportion=n()) %>%
group_by(dx) %>%
mutate(Proportion=Proportion/sum(Proportion))
createDT(cell_proportions)
prop.ID <- ggplot(cell_proportions, aes(x=ID, y=Proportion, fill = Cluster)) +
geom_col() + # position="dodge"
ylab("Proportion of Cells") + facet_grid("~dx")
print(prop.ID)
# By mut
cell_proportions <- meta %>%
group_by(dx, Cluster, ID) %>%
summarise(Proportion=n()) %>%
group_by(ID) %>%
mutate(Proportion=Proportion/sum(Proportion))
createDT(cell_proportions)
prop.ID <- ggplot(cell_proportions, aes(x=ID, y=Proportion, fill = Cluster)) +
geom_col() + # position="dodge"
ylab("Proportion of Cells") + facet_grid("~dx")
print(prop.ID)
prop.ID <- ggplot(cell_proportions, aes(x=ID, y=Proportion, fill = Cluster)) +
geom_col() + # position="dodge"
ylab("Proportion of Cells") + facet_grid("~dx") + theme(axis.text.x = element_text(angle = 45))
print(prop.ID)
prop.ID <- ggplot(cell_proportions, aes(x=ID, y=Proportion, fill = Cluster)) +
geom_col() + # position="dodge"
ylab("Proportion of Cells") +
facet_grid("~dx") +
theme(axis.text.x = element_text(angle = 45, vjust = -1))
print(prop.ID)
prop.ID <- ggplot(cell_proportions, aes(x=ID, y=Proportion, fill = Cluster)) +
geom_col() + # position="dodge"
ylab("Proportion of Cells") +
facet_grid("~dx") +
theme(axis.text.x = element_text(angle = 45, vjust = -.01))
print(prop.ID)
prop.ID <- ggplot(cell_proportions, aes(x=ID, y=Proportion, fill = Cluster)) +
geom_col() + # position="dodge"
ylab("Proportion of Cells") +
facet_grid("~dx") +
theme(axis.text.x = element_text(angle = 45, vjust = -.0011))
prop.ID <- ggplot(cell_proportions, aes(x=ID, y=Proportion, fill = Cluster)) +
geom_col() + # position="dodge"
ylab("Proportion of Cells") +
facet_grid("~dx") +
theme(axis.text.x = element_text(angle = 45, vjust = -.0001))
print(prop.ID)
prop.ID <- ggplot(cell_proportions, aes(x=ID, y=Proportion, fill = Cluster)) +
geom_col() + # position="dodge"
ylab("Proportion of Cells") +
facet_grid("~dx") +
theme(axis.text.x = element_text(angle = 45, vjust = -.00001))
print(prop.ID)
prop.ID <- ggplot(cell_proportions, aes(x=ID, y=Proportion, fill = Cluster)) +
geom_col() + # position="dodge"
ylab("Proportion of Cells") +
facet_grid("~dx") +
theme(axis.text.x = element_text(angle = 45, vjust = -.0000001))
print(prop.ID)
prop.ID <- ggplot(cell_proportions, aes(x=ID, y=Proportion, fill = Cluster)) +
geom_col() + # position="dodge"
ylab("Proportion of Cells") +
facet_grid("~dx") +
theme(axis.text.x = element_text(angle = 45, vjust = .0000001))
print(prop.ID)
prop.ID <- ggplot(cell_proportions, aes(x=ID, y=Proportion, fill = Cluster)) +
geom_col() + # position="dodge"
ylab("Proportion of Cells") +
facet_grid("~dx") +
theme(axis.text.x = element_text(angle = 45))
print(prop.ID)
