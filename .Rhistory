geom_cladelabel(node=NWM, label="NWM", color="green",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=NWM, fill="green", alpha=alpha) +
geom_cladelabel(node=tarsi, label="Tarsiiformes", color="blue",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=tarsi, fill="blue", alpha=alpha) +
geom_cladelabel(node=strep, label="Strepsirrhines", color="purple",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=strep, fill="purple", alpha=alpha) +
geom_nodepoint() +
geom_hilight_encircle(node = 44, spread=.01, fill = "gold") +
# geom_tippoint() +
geom_tiplab(offset = 5) +
xlim(0, 120)  +
# geom_text(aes(label=node.ages$ages), hjust=-.25) +
geom_text(aes(label=node), hjust=-.25) +
geom_treescale(color="darkgray", linesize=2, width=10, y= -2, offset= -1) +
theme_tree()
gt
# data.frame(sort(tree$tip.label))
homo <- 31 #MRCA(tree, tip=c("Homo_sapiens", "Homo_sapiens"))
gt <- ggtree(tree) +  #  aes(color=group, linetype=group)
geom_cladelabel(node=apes, label="Apes", color="red2",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=apes, fill="red2", alpha=alpha) +
geom_cladelabel(node=OWM, label="OWM", color="orange",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=OWM, fill="orange", alpha=alpha) +
geom_cladelabel(node=NWM, label="NWM", color="green",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=NWM, fill="green", alpha=alpha) +
geom_cladelabel(node=tarsi, label="Tarsiiformes", color="blue",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=tarsi, fill="blue", alpha=alpha) +
geom_cladelabel(node=strep, label="Strepsirrhines", color="purple",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=strep, fill="purple", alpha=alpha) +
geom_nodepoint() +
geom_hilight_encircle(node = 31, spread=.02, fill = "gold", s_shape=23) +
# geom_tippoint() +
geom_tiplab(offset = 5) +
xlim(0, 120)  +
# geom_text(aes(label=node.ages$ages), hjust=-.25) +
geom_text(aes(label=node), hjust=-.25) +
geom_treescale(color="darkgray", linesize=2, width=10, y= -2, offset= -1) +
theme_tree()
gt
gt <- ggtree(tree) +  #  aes(color=group, linetype=group)
geom_cladelabel(node=apes, label="Apes", color="red2",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=apes, fill="red2", alpha=alpha) +
geom_cladelabel(node=OWM, label="OWM", color="orange",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=OWM, fill="orange", alpha=alpha) +
geom_cladelabel(node=NWM, label="NWM", color="green",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=NWM, fill="green", alpha=alpha) +
geom_cladelabel(node=tarsi, label="Tarsiiformes", color="blue",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=tarsi, fill="blue", alpha=alpha) +
geom_cladelabel(node=strep, label="Strepsirrhines", color="purple",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=strep, fill="purple", alpha=alpha) +
geom_nodepoint() +
geom_hilight_encircle(node = 31, spread=.02, fill = "gold", s_shape= -.5) +
# geom_tippoint() +
geom_tiplab(offset = 5) +
xlim(0, 120)  +
# geom_text(aes(label=node.ages$ages), hjust=-.25) +
geom_text(aes(label=node), hjust=-.25) +
geom_treescale(color="darkgray", linesize=2, width=10, y= -2, offset= -1) +
theme_tree()
gt
gt <- ggtree(tree) +  #  aes(color=group, linetype=group)
geom_cladelabel(node=apes, label="Apes", color="red2",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=apes, fill="red2", alpha=alpha) +
geom_cladelabel(node=OWM, label="OWM", color="orange",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=OWM, fill="orange", alpha=alpha) +
geom_cladelabel(node=NWM, label="NWM", color="green",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=NWM, fill="green", alpha=alpha) +
geom_cladelabel(node=tarsi, label="Tarsiiformes", color="blue",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=tarsi, fill="blue", alpha=alpha) +
geom_cladelabel(node=strep, label="Strepsirrhines", color="purple",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=strep, fill="purple", alpha=alpha) +
geom_nodepoint() +
geom_hilight_encircle(node = 31, spread=.02, fill = "gold", s_shape= .5) +
# geom_tippoint() +
geom_tiplab(offset = 5) +
xlim(0, 120)  +
# geom_text(aes(label=node.ages$ages), hjust=-.25) +
geom_text(aes(label=node), hjust=-.25) +
geom_treescale(color="darkgray", linesize=2, width=10, y= -2, offset= -1) +
theme_tree()
gt
gt <- ggtree(tree) +  #  aes(color=group, linetype=group)
geom_cladelabel(node=apes, label="Apes", color="red2",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=apes, fill="red2", alpha=alpha) +
geom_cladelabel(node=OWM, label="OWM", color="orange",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=OWM, fill="orange", alpha=alpha) +
geom_cladelabel(node=NWM, label="NWM", color="green",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=NWM, fill="green", alpha=alpha) +
geom_cladelabel(node=tarsi, label="Tarsiiformes", color="blue",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=tarsi, fill="blue", alpha=alpha) +
geom_cladelabel(node=strep, label="Strepsirrhines", color="purple",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=strep, fill="purple", alpha=alpha) +
geom_nodepoint() +
geom_hilight_encircle(node = 31, spread=.02, fill = "gold", s_shape= .7) +
# geom_tippoint() +
geom_tiplab(offset = 5) +
xlim(0, 120)  +
# geom_text(aes(label=node.ages$ages), hjust=-.25) +
geom_text(aes(label=node), hjust=-.25) +
geom_treescale(color="darkgray", linesize=2, width=10, y= -2, offset= -1) +
theme_tree()
gt
gt <- ggtree(tree) +  #  aes(color=group, linetype=group)
geom_cladelabel(node=apes, label="Apes", color="red2",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=apes, fill="red2", alpha=alpha) +
geom_cladelabel(node=OWM, label="OWM", color="orange",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=OWM, fill="orange", alpha=alpha) +
geom_cladelabel(node=NWM, label="NWM", color="green",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=NWM, fill="green", alpha=alpha) +
geom_cladelabel(node=tarsi, label="Tarsiiformes", color="blue",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=tarsi, fill="blue", alpha=alpha) +
geom_cladelabel(node=strep, label="Strepsirrhines", color="purple",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=strep, fill="purple", alpha=alpha) +
geom_nodepoint() +
geom_hilight_encircle(node = 31, spread=.02, fill = "gold", s_shape= 1) +
# geom_tippoint() +
geom_tiplab(offset = 5) +
xlim(0, 120)  +
# geom_text(aes(label=node.ages$ages), hjust=-.25) +
geom_text(aes(label=node), hjust=-.25) +
geom_treescale(color="darkgray", linesize=2, width=10, y= -2, offset= -1) +
theme_tree()
gt
gt <- ggtree(tree) +  #  aes(color=group, linetype=group)
geom_cladelabel(node=apes, label="Apes", color="red2",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=apes, fill="red2", alpha=alpha) +
geom_cladelabel(node=OWM, label="OWM", color="orange",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=OWM, fill="orange", alpha=alpha) +
geom_cladelabel(node=NWM, label="NWM", color="green",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=NWM, fill="green", alpha=alpha) +
geom_cladelabel(node=tarsi, label="Tarsiiformes", color="blue",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=tarsi, fill="blue", alpha=alpha) +
geom_cladelabel(node=strep, label="Strepsirrhines", color="purple",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=strep, fill="purple", alpha=alpha) +
geom_nodepoint() +
geom_hilight_encircle(node = 31, spread=.02, fill = "gold", s_shape= 1, offset=.5) +
# geom_tippoint() +
geom_tiplab(offset = 5) +
xlim(0, 120)  +
# geom_text(aes(label=node.ages$ages), hjust=-.25) +
geom_text(aes(label=node), hjust=-.25) +
geom_treescale(color="darkgray", linesize=2, width=10, y= -2, offset= -1) +
theme_tree()
gt <- ggtree(tree) +  #  aes(color=group, linetype=group)
geom_cladelabel(node=apes, label="Apes", color="red2",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=apes, fill="red2", alpha=alpha) +
geom_cladelabel(node=OWM, label="OWM", color="orange",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=OWM, fill="orange", alpha=alpha) +
geom_cladelabel(node=NWM, label="NWM", color="green",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=NWM, fill="green", alpha=alpha) +
geom_cladelabel(node=tarsi, label="Tarsiiformes", color="blue",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=tarsi, fill="blue", alpha=alpha) +
geom_cladelabel(node=strep, label="Strepsirrhines", color="purple",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=strep, fill="purple", alpha=alpha) +
geom_nodepoint() +
geom_hilight_encircle(node = 31, spread=.02, fill = "gold", s_shape= 1, hjust=.5) +
# geom_tippoint() +
geom_tiplab(offset = 5) +
xlim(0, 120)  +
# geom_text(aes(label=node.ages$ages), hjust=-.25) +
geom_text(aes(label=node), hjust=-.25) +
geom_treescale(color="darkgray", linesize=2, width=10, y= -2, offset= -1) +
theme_tree()
gt <- ggtree(tree) +  #  aes(color=group, linetype=group)
geom_cladelabel(node=apes, label="Apes", color="red2",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=apes, fill="red2", alpha=alpha) +
geom_cladelabel(node=OWM, label="OWM", color="orange",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=OWM, fill="orange", alpha=alpha) +
geom_cladelabel(node=NWM, label="NWM", color="green",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=NWM, fill="green", alpha=alpha) +
geom_cladelabel(node=tarsi, label="Tarsiiformes", color="blue",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=tarsi, fill="blue", alpha=alpha) +
geom_cladelabel(node=strep, label="Strepsirrhines", color="purple",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=strep, fill="purple", alpha=alpha) +
geom_nodepoint() +
geom_hilight_encircle(node = 31, spread=.02, fill = "gold", s_shape= 1,x_nudge=.5) +
# geom_tippoint() +
geom_tiplab(offset = 5) +
xlim(0, 120)  +
# geom_text(aes(label=node.ages$ages), hjust=-.25) +
geom_text(aes(label=node), hjust=-.25) +
geom_treescale(color="darkgray", linesize=2, width=10, y= -2, offset= -1) +
theme_tree()
gt <- ggtree(tree) +  #  aes(color=group, linetype=group)
geom_cladelabel(node=apes, label="Apes", color="red2",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=apes, fill="red2", alpha=alpha) +
geom_cladelabel(node=OWM, label="OWM", color="orange",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=OWM, fill="orange", alpha=alpha) +
geom_cladelabel(node=NWM, label="NWM", color="green",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=NWM, fill="green", alpha=alpha) +
geom_cladelabel(node=tarsi, label="Tarsiiformes", color="blue",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=tarsi, fill="blue", alpha=alpha) +
geom_cladelabel(node=strep, label="Strepsirrhines", color="purple",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=strep, fill="purple", alpha=alpha) +
geom_nodepoint() +
geom_hilight_encircle(node = 31, spread=.02, fill = "gold", s_shape= 1) +
# geom_tippoint() +
geom_tiplab(offset = 5) +
xlim(0, 120)  +
# geom_text(aes(label=node.ages$ages), hjust=-.25) +
geom_text(aes(label=node), hjust=-.25) +
geom_treescale(color="darkgray", linesize=2, width=10, y= -2, offset= -1) +
theme_tree()
gt
gt <- ggtree(tree) +  #  aes(color=group, linetype=group)
geom_cladelabel(node=apes, label="Apes", color="red2",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=apes, fill="red2", alpha=alpha) +
geom_cladelabel(node=OWM, label="OWM", color="orange",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=OWM, fill="orange", alpha=alpha) +
geom_cladelabel(node=NWM, label="NWM", color="green",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=NWM, fill="green", alpha=alpha) +
geom_cladelabel(node=tarsi, label="Tarsiiformes", color="blue",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=tarsi, fill="blue", alpha=alpha) +
geom_cladelabel(node=strep, label="Strepsirrhines", color="purple",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=strep, fill="purple", alpha=alpha) +
geom_nodepoint() +
geom_hilight_encircle(node = 31, spread=.01, fill = "gold", s_shape= 1) +
# geom_tippoint() +
geom_tiplab(offset = 5) +
xlim(0, 120)  +
# geom_text(aes(label=node.ages$ages), hjust=-.25) +
geom_text(aes(label=node), hjust=-.25) +
geom_treescale(color="darkgray", linesize=2, width=10, y= -2, offset= -1) +
theme_tree()
gt
gt <- ggtree(tree) +  #  aes(color=group, linetype=group)
geom_cladelabel(node=apes, label="Apes", color="red2",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=apes, fill="red2", alpha=alpha) +
geom_cladelabel(node=OWM, label="OWM", color="orange",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=OWM, fill="orange", alpha=alpha) +
geom_cladelabel(node=NWM, label="NWM", color="green",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=NWM, fill="green", alpha=alpha) +
geom_cladelabel(node=tarsi, label="Tarsiiformes", color="blue",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=tarsi, fill="blue", alpha=alpha) +
geom_cladelabel(node=strep, label="Strepsirrhines", color="purple",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=strep, fill="purple", alpha=alpha) +
geom_nodepoint() +
geom_hilight_encircle(node = 31, spread=.015, fill = "gold", s_shape= 1) +
# geom_tippoint() +
geom_tiplab(offset = 5) +
xlim(0, 120)  +
# geom_text(aes(label=node.ages$ages), hjust=-.25) +
geom_text(aes(label=node), hjust=-.25) +
geom_treescale(color="darkgray", linesize=2, width=10, y= -2, offset= -1) +
theme_tree()
gt
/geom_hilight
?geom_hilight
gt <- ggtree(tree) +  #  aes(color=group, linetype=group)
geom_cladelabel(node=apes, label="Apes", color="red2",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=apes, fill="red2", alpha=alpha) +
geom_cladelabel(node=OWM, label="OWM", color="orange",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=OWM, fill="orange", alpha=alpha) +
geom_cladelabel(node=NWM, label="NWM", color="green",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=NWM, fill="green", alpha=alpha) +
geom_cladelabel(node=tarsi, label="Tarsiiformes", color="blue",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=tarsi, fill="blue", alpha=alpha) +
geom_cladelabel(node=strep, label="Strepsirrhines", color="purple",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=strep, fill="purple", alpha=alpha) +
geom_nodepoint() +
geom_hilight_encircle(node = 31, spread=.015, fill = "gold", s_shape= 1) +
# geom_tippoint() +
geom_tiplab(offset = 5) +
xlim(0, 120)  +
# geom_text(aes(label=node.ages$ages), hjust=-.25) +
geom_text(aes(label=node), hjust=-.25) +
geom_treescale(color="darkgray", linesize=2, width=10, y= -2, offset= -1) +
theme_tree() + rotate(node = 45)
gt
rotate(node = 45)
rotate(node = 47)
rotate(node = 48)
# data.frame(sort(tree$tip.label))
homo <- 31 #MRCA(tree, tip=c("Homo_sapiens", "Homo_sapiens"))
apes <- MRCA(tree, tip=c("Hylobates_lar", "Homo_sapiens"))
OWM <- MRCA(tree, tip=c("Pygathrix_nemaeus", "Cercopithecus_mitis"))
NWM <-  MRCA(tree, tip=c("Callicebus_moloch", "Alouatta_caraya"))
tarsi <- 44 #MRCA(tree, tip=c("Tarsius_bancanus", "Tarsius_bancanus"))
strep <-  MRCA(tree, tip=c("Galagoides_demidoff", "Microcebus_murinus"))
# Calculate the ages of all the nodes
node.ages <- tree.age(tree, 65, order = "past", fossil = F, digits = 1)
node.ages$ages[node.ages$ages == 0] <- ""
angle = -90
offset = 40
offset.text = .3
alpha = .5
tree <- groupClade(tree, .node=47)
gt <- ggtree(tree) +  #  aes(color=group, linetype=group)
geom_cladelabel(node=apes, label="Apes", color="red2",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=apes, fill="red2", alpha=alpha) +
geom_cladelabel(node=OWM, label="OWM", color="orange",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=OWM, fill="orange", alpha=alpha) +
geom_cladelabel(node=NWM, label="NWM", color="green",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=NWM, fill="green", alpha=alpha) +
# geom_cladelabel(node=tarsi, label="Tarsiiformes", color="blue",
# offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=tarsi, fill="blue", alpha=alpha) +
geom_cladelabel(node=strep, label="Strepsirrhines", color="purple",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=strep, fill="purple", alpha=alpha) +
geom_nodepoint() +
geom_hilight_encircle(node = 31, spread=.015, fill = "gold", s_shape= 1) +
# geom_tippoint() +
geom_tiplab(offset = 5) +
xlim(0, 120)  +
geom_text(aes(label=node.ages$ages), hjust=-.25) +
# geom_text(aes(label=node), hjust=-.25) +
geom_treescale(color="darkgray", linesize=2, width=10, y= -2, offset= -1) +
theme_tree()
gt
# Rearrange clades
rotate(node = 45)
rotate(node = 47)
rotate(node = 48)
shiftNodes <- c(apes, OWM, NWM, tarsi, strep)
image_info <- data.frame(node = shiftNodes,
images = rep("https://i.imgur.com/8VA9cYw.png", length(shiftNodes) )
)
phylopic_info <- data.frame(node = c(apes, OWM, NWM, tarsi, strep),
phylopic = c("0174801d-15a6-4668-bfe0-4c421fbe51e8",
"72f2f854-f3cd-4666-887c-35d5c256ab0f",
"aceb287d-84cf-46f1-868c-4797c4ac54a8",
"f598fb39-facf-43ea-a576-1861304b2fe4",
"bac25f49-97a4-4aec-beb6-f542158ebd23"
),
species = c("Apes", "OWM", "NWM",
"Tarsiiformes", "Strepsirrhines"
))
gt %<+% phylopic_info + geom_nodelab(aes(image=phylopic), geom="phylopic",
alpha=.5, color='steelblue',nudge_x = -5)
# gt %<+% image_info + geom_nodelab(aes(image=images), geom="image", alpha=.7, color='green',nudge_x = -5)
# data.frame(sort(tree$tip.label))
homo <- 31 #MRCA(tree, tip=c("Homo_sapiens", "Homo_sapiens"))
apes <- MRCA(tree, tip=c("Hylobates_lar", "Homo_sapiens"))
OWM <- MRCA(tree, tip=c("Pygathrix_nemaeus", "Cercopithecus_mitis"))
NWM <-  MRCA(tree, tip=c("Callicebus_moloch", "Alouatta_caraya"))
tarsi <- 44 #MRCA(tree, tip=c("Tarsius_bancanus", "Tarsius_bancanus"))
strep <-  MRCA(tree, tip=c("Galagoides_demidoff", "Microcebus_murinus"))
# Calculate the ages of all the nodes
node.ages <- tree.age(tree, 65, order = "past", fossil = F, digits = 1)
node.ages$ages[node.ages$ages == 0] <- ""
angle = -90
offset = 40
offset.text = .3
alpha = .5
tree <- groupClade(tree, .node=47)
gt <- ggtree(tree) +  #  aes(color=group, linetype=group)
geom_cladelabel(node=apes, label="Apes", color="red2",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=apes, fill="red2", alpha=alpha) +
geom_cladelabel(node=OWM, label="OWM", color="orange",
offset=offset, angle=angle, offset.text = offset.text) +
geom_hilight(node=OWM, fill="orange", alpha=alpha) +
geom_cladelabel(node=NWM, label="NWM", color="green",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=NWM, fill="green", alpha=alpha) +
# geom_cladelabel(node=tarsi, label="Tarsiiformes", color="blue",
# offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=tarsi, fill="blue", alpha=alpha) +
geom_cladelabel(node=strep, label="Strepsirrhines", color="purple",
offset=offset, angle=angle,  offset.text = offset.text) +
geom_hilight(node=strep, fill="purple", alpha=alpha) +
geom_nodepoint() +
geom_hilight_encircle(node = 31, spread=.015, fill = "gold", s_shape= 1) +
# geom_tippoint() +
geom_tiplab(offset = 5) +
xlim(0, 120)  +
geom_text(aes(label=node.ages$ages), hjust=-.25) +
# geom_text(aes(label=node), hjust=-.25) +
geom_treescale(color="darkgray", linesize=2, width=10, y= -2, offset= -1) +
theme_tree()
gt
shiftNodes <- c(apes, OWM, NWM, tarsi, strep)
image_info <- data.frame(node = shiftNodes,
images = rep("https://i.imgur.com/8VA9cYw.png", length(shiftNodes) )
)
phylopic_info <- data.frame(node = c(apes, OWM, NWM, tarsi, strep),
phylopic = c("0174801d-15a6-4668-bfe0-4c421fbe51e8",
"72f2f854-f3cd-4666-887c-35d5c256ab0f",
"aceb287d-84cf-46f1-868c-4797c4ac54a8",
"f598fb39-facf-43ea-a576-1861304b2fe4",
"bac25f49-97a4-4aec-beb6-f542158ebd23"
),
species = c("Apes", "OWM", "NWM",
"Tarsiiformes", "Strepsirrhines"
))
gt %<+% phylopic_info + geom_nodelab(aes(image=phylopic), geom="phylopic",
alpha=.5, color='steelblue',nudge_x = -5)
# gt %<+% image_info + geom_nodelab(aes(image=images), geom="image", alpha=.7, color='green',nudge_x = -5)
# Rearrange clades
rotate(node = 45)
rotate(node = 47)
rotate(node = 48)
library(Seurat)
library(dplyr)
library(gridExtra)
library(knitr)
library(plotly)
library(ggplot2)
library(reshape2)
library(shiny)
library(ggrepel)
library(DT)
createDT <- function(DF, caption="", scrollY=500){
data <- datatable(DF, caption=caption,
extensions = 'Buttons',
options = list( dom = 'Bfrtip',
buttons = c('copy', 'csv', 'excel', 'pdf', 'print'),
scrollY = scrollY, paging = F
)
)
print(data)
}
#
# install.packages('devtools')
# devtools::install_github('talgalili/heatmaply')
## Install Bioconductor
#  if (!requireNamespace("BiocManager"))
#     install.packages("BiocManager")
# BiocManager::install(c("biomaRt"))
library(biomaRt)
# BiocManager::install(c("DESeq2"))
library(DESeq2)
# Useful Seurat functions
## Seurat::FindGeneTerms() # Enrichr API
## Seurat::MultiModal_CCA() # Integrates data from disparate datasets (CIA version too)
sessionInfo()
print(paste("Seurat ", packageVersion("Seurat")))
#setwd("~/Desktop/PD_scRNAseq/")
dir.create(file.path(root,"Data"), showWarnings=F)
cd ..
#setwd("~/Desktop/PD_scRNAseq/")
dir.create(file.path(root,"Data"), showWarnings=F)
setwd("~/Desktop/PD_scRNAseq/")
# setwd("~/Desktop/PD_scRNAseq/")
dir.create(file.path(root,"Data"), showWarnings=F)
getwd()
setwd("~/Desktop/PD_scRNAseq/")
dir.create(file.path(root,"Data"), showWarnings=F)
getwed()
getwd()
setwd("~/Desktop/PD_scRNAseq/")
)
setwd("~/Desktop/PD_scRNAseq/")
setwd("~/Desktop/PD_scRNAseq/")
dir.create(file.path(root,"Data"), showWarnings=F)
